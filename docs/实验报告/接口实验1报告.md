# 实验报告单

**实验名称：** 3. 8255接口实验 - 端口地址译码电路及简单输出端口设计

**实验室：** 产教融合大楼A301/通识机房508
**时间：** 2025.11.18

---

## 实验项目

### 一、实验目的

1. 学会分析端口地址译码电路，确定各I/O端口的地址；
2. 掌握OUT指令的使用方法，实现对输出端口的控制；
3. 通过编程实现LED流水灯效果，加深对I/O接口的理解；
4. 熟悉Proteus仿真平台的使用方法。

---

### 二、端口地址分析

**（3）各I/O端口地址表**

| 端口号 | A₁₅ | A₁₄ | A₁₃ | A₁₂ | A₁₁ | A₁₀ | A₉ | A₈ | A₇ | A₆ | A₅ | A₄ | A₃ | A₂ | A₁ | A₀ | 十六进制地址 |
|--------|-----|-----|-----|-----|-----|-----|----|----|----|----|----|----|----|----|----|----| ------------ |
| IO0    | 0   | 0   | 0   | 0   | 0   | 0   | 1  | 0  | 0  | 0  | 0  | 0  | 0  | 0  | 0  | 0  | 0200H        |
| IO1    | 0   | 0   | 0   | 0   | 0   | 0   | 1  | 0  | 0  | 0  | 0  | 0  | 0  | 0  | 0  | 1  | 0201H        |
| IO2    | 0   | 0   | 0   | 0   | 0   | 0   | 1  | 0  | 0  | 0  | 0  | 0  | 0  | 0  | 1  | 0  | 0202H        |
| IO3    | 0   | 0   | 0   | 0   | 0   | 0   | 1  | 0  | 0  | 0  | 0  | 0  | 0  | 0  | 1  | 1  | 0203H        |
| IO4    | 0   | 0   | 0   | 0   | 0   | 0   | 1  | 0  | 0  | 0  | 0  | 0  | 0  | 1  | 0  | 0  | 0204H        |
| IO5    | 0   | 0   | 0   | 0   | 0   | 0   | 1  | 0  | 0  | 0  | 0  | 0  | 0  | 1  | 0  | 1  | 0205H        |
| IO6    | 0   | 0   | 0   | 0   | 0   | 0   | 1  | 0  | 0  | 0  | 0  | 0  | 0  | 1  | 1  | 0  | 0206H        |
| IO7    | 0   | 0   | 0   | 0   | 0   | 0   | 1  | 0  | 0  | 0  | 0  | 0  | 0  | 1  | 1  | 1  | 0207H        |
| IO8    | 0   | 0   | 0   | 0   | 0   | 0   | 1  | 0  | 0  | 0  | 0  | 0  | 1  | 0  | 0  | 0  | 0208H        |
| IO9    | 0   | 0   | 0   | 0   | 0   | 0   | 1  | 0  | 0  | 0  | 0  | 0  | 1  | 0  | 0  | 1  | 0209H        |
| IO10   | 0   | 0   | 0   | 0   | 0   | 0   | 1  | 0  | 0  | 0  | 0  | 0  | 1  | 0  | 1  | 0  | 020AH        |
| IO11   | 0   | 0   | 0   | 0   | 0   | 0   | 1  | 0  | 0  | 0  | 0  | 0  | 1  | 0  | 1  | 1  | 020BH        |
| IO12   | 0   | 0   | 0   | 0   | 0   | 0   | 1  | 0  | 0  | 0  | 0  | 0  | 1  | 1  | 0  | 0  | 020CH        |
| IO13   | 0   | 0   | 0   | 0   | 0   | 0   | 1  | 0  | 0  | 0  | 0  | 0  | 1  | 1  | 0  | 1  | 020DH        |
| IO14   | 0   | 0   | 0   | 0   | 0   | 0   | 1  | 0  | 0  | 0  | 0  | 0  | 1  | 1  | 1  | 0  | 020EH        |
| IO15   | 0   | 0   | 0   | 0   | 0   | 0   | 1  | 0  | 0  | 0  | 0  | 0  | 1  | 1  | 1  | 1  | 020FH        |

**地址计算公式：**
```
端口地址 = 基地址 + 端口号
IOx地址 = 0200H + x（x = 0~15）
```

---

### 三、实验步骤

1. 在Proteus中搭建硬件电路（8086、74LS273、LED等）
2. 设置8086的"Internal Memory Size"为"0x10000"
3. 编写LED流水灯汇编程序
4. 编译程序并生成可执行文件
5. 启动仿真调试，观察LED流水灯效果

---

### 四、实验代码

```assembly
;============================================================
; 软件延时流水灯程序 - 8086汇编
;
; 硬件配置:
;   - 74LS273锁存器 (端口地址: 200H)
;   - 16个LED连接至锁存器输出端 (低电平点亮)
;
; 功能描述:
;   实现16位LED循环流水效果
;   通过LOOP指令实现延时控制流水速度
;   LED依次从右向左点亮,循环往复
;============================================================

CODE    SEGMENT PUBLIC 'CODE'
        ASSUME CS:CODE

START:
;------------------------------------------------------------
; 主程序入口
;------------------------------------------------------------

;--------------- 初始化LED状态 ---------------
        MOV DX, 0200H           ; DX = 200H,设置I/O端口地址
                                ; 200H是74LS273锁存器的端口地址

        MOV AX, 0FFFFH          ; AX = FFFFH = 1111 1111 1111 1111
                                ; 全为1,所有LED熄灭(低电平点亮)

        OUT DX, AX              ; 将AX输出到端口,熄灭所有LED
                                ; 这是初始化,确保开始时LED全灭

        MOV AX, 0FFFEH          ; AX = FFFEH = 1111 1111 1111 1110
                                ; 最低位为0,准备点亮LED0

;--------------- 流水灯主循环 ---------------
AGAIN:
        ROL AX, 1               ; AX循环左移1位
                                ; 第1次: FFFEH→FFFDH,LED1亮
                                ; 第2次: FFFDH→FFFBH,LED2亮
                                ; 第3次: FFFBH→FFF7H,LED3亮
                                ; ...依此类推

        OUT DX, AX              ; 将AX输出到74LS273锁存器
                                ; LED显示状态随之改变
                                ; 哪一位是0,对应的LED就亮

        LOOP $                  ; 延时循环1
                                ; $表示当前地址,即跳转到自身
                                ; CX不断减1直到为0才退出

        LOOP $                  ; 延时循环2
                                ; 两次LOOP $延时更长
                                ; 让LED状态保持足够时间

        JMP AGAIN               ; 无条件跳转回AGAIN标签
                                ; 形成无限循环

CODE    ENDS
        END START
```

---

### 五、实验结果与数据记录

#### 5.1 LED流水灯状态变化记录

| 循环次数 | AX值   | 二进制表示              | 点亮LED | 说明                 |
|----------|--------|------------------------|---------|---------------------|
| 初始     | 0FFFEH | 1111 1111 1111 1110    | LED0    | 最右侧LED点亮       |
| 第1次    | 0FFFDH | 1111 1111 1111 1101    | LED1    | 向左移动一位        |
| 第2次    | 0FFFBH | 1111 1111 1111 1011    | LED2    | 继续向左移动        |
| 第3次    | 0FFF7H | 1111 1111 1111 0111    | LED3    | 继续向左移动        |
| 第4次    | 0FFEFH | 1111 1111 1110 1111    | LED4    | 继续向左移动        |
| 第5次    | 0FFDFH | 1111 1111 1101 1111    | LED5    | 继续向左移动        |
| 第6次    | 0FFBFH | 1111 1111 1011 1111    | LED6    | 继续向左移动        |
| 第7次    | 0FF7FH | 1111 1111 0111 1111    | LED7    | 继续向左移动        |
| 第8次    | 0FEFFH | 1111 1110 1111 1111    | LED8    | 高字节开始变化      |
| 第9次    | 0FDFFH | 1111 1101 1111 1111    | LED9    | 继续向左移动        |
| 第10次   | 0FBFFH | 1111 1011 1111 1111    | LED10   | 继续向左移动        |
| 第11次   | 0F7FFH | 1111 0111 1111 1111    | LED11   | 继续向左移动        |
| 第12次   | 0EFFFH | 1110 1111 1111 1111    | LED12   | 继续向左移动        |
| 第13次   | 0DFFFH | 1101 1111 1111 1111    | LED13   | 继续向左移动        |
| 第14次   | 0BFFFH | 1011 1111 1111 1111    | LED14   | 继续向左移动        |
| 第15次   | 07FFFH | 0111 1111 1111 1111    | LED15   | 最左侧LED点亮       |
| 第16次   | 0FFFEH | 1111 1111 1111 1110    | LED0    | 循环回到初始状态    |

#### 5.2 寄存器变化记录

使用Proteus的寄存器窗口观察关键寄存器变化：

| 执行阶段         | DX值  | AX值   | 说明                       |
|------------------|-------|--------|---------------------------|
| 初始化           | 0200H | 0FFFFH | 设置端口地址，熄灭所有LED |
| 准备第一个LED    | 0200H | 0FFFEH | 准备点亮LED0              |
| 第1次ROL后       | 0200H | 0FFFDH | LED1准备点亮              |
| 第1次OUT后       | 0200H | 0FFFDH | LED1实际点亮              |
| 第2次ROL后       | 0200H | 0FFFBH | LED2准备点亮              |
| 第2次OUT后       | 0200H | 0FFFBH | LED2实际点亮              |

---

### 六、实验现象与分析

实验成功实现了16位LED流水灯效果：
- LED依次从右向左点亮（LED0 → LED1 → ... → LED15）
- 每次只有一个LED点亮，其余LED熄灭
- 循环往复，形成连续的流水效果
- ROL指令实现循环移位，16次后自动回到初始状态

---

### 七、思考题

**思考1：74LS273分别锁存什么信号？**

**答：**
- 第1片74LS273（U1）：锁存数据总线低8位（AD0-AD7），对应LED0-LED7
- 第2片74LS273（U2）：锁存数据总线高8位（AD8-AD15），对应LED8-LED15
- 锁存信号：8086的WR（写信号）作为CLK时钟信号

**思考2：如何实现AD0-AD15上地址信息与数据信息的分离？**

**答：**

8086采用地址/数据总线复用方式，AD0-AD15既传输地址又传输数据，分离方法：

1. **时序分离**：
   - T1状态：AD0-AD15输出地址
   - T2-T4状态：AD0-AD15传输数据

2. **硬件分离**：
   - 使用74LS373锁存器锁存地址
   - ALE（地址锁存使能）信号控制
   - ALE高电平时锁存地址，ALE低电平后地址保持，数据总线可传输数据

3. **本实验中的实现**：
   - 由于使用I/O端口，地址由DX寄存器提供（独立地址总线）
   - 数据由AX寄存器提供（数据总线）
   - 无需额外分离电路

**思考3：M/IO、RD、WR、ALE引脚分别代表什么信号？**

**答：**

| 引脚   | 信号名称           | 功能说明                                          |
|--------|--------------------|--------------------------------------------------|
| M/IO   | 存储器/IO选择      | 高电平：访问存储器；低电平：访问I/O端口          |
| RD     | 读信号（低有效）   | 低电平有效，表示CPU正在从存储器或I/O读取数据     |
| WR     | 写信号（低有效）   | 低电平有效，表示CPU正在向存储器或I/O写入数据     |
| ALE    | 地址锁存使能       | 高电平有效，用于锁存地址信号（T1状态）           |

**思考4：执行OUT指令时，总线操作的时序？**

**答：**

OUT指令执行时的总线时序（以`OUT DX, AX`为例）：

```
时钟周期：  T1        T2        T3        T4
          ─────┐   ┌─────┐   ┌─────┐   ┌─────
CLK            └───┘     └───┘     └───┘

ALE        ───┐     ┌─────────────────────────
               └─────┘

AD0-AD15   <地址><────── 数据AX ──────>

M/IO       ─────────────┐     ┌──────────────
                        └─────┘  (低电平=IO)

WR         ─────────────┐     ┌──────────────
                        └─────┘  (低电平有效)
```

**时序说明：**
1. **T1状态**：
   - ALE高电平，AD0-AD15输出端口地址（来自DX）
   - M/IO=0（I/O操作）

2. **T2状态**：
   - ALE变为低电平，地址被锁存
   - AD0-AD15切换为数据（AX的值）
   - WR变为低电平，开始写操作

3. **T3状态**：
   - 保持WR低电平
   - 数据稳定输出在AD0-AD15上
   - 74LS273在WR上升沿锁存数据

4. **T4状态**：
   - WR恢复高电平
   - 写操作完成
   - 74LS273输出端保持锁存的数据


---

**成绩：**

**批阅教师：** ————————

**日    期：** ————————
